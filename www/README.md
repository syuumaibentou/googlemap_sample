#現在位置を計測し、地図で表示するアプリ

- 今回はgeolocationプラグインを使用して、現在位置を地図上に表示、マーカーを出力するアプリを作ります！
- 地図の出力にはgooglemapAPIを用います。
- プロジェクトのテンプレートは「Onsen UI最小限のプロジェクト」になっています。
- Monacaさんの公式ガイドブック「クラウドでできるHTML5ハイブリッドアプリ開発」を参考にしております。

3. まずはjQueryプラグインをインストールしてみましょう！
    - [設定]→[JS/CSSコンポーネントの追加と削除]→[jQuery(Monaca version)]を追加してください。
    - もしくはjQueryのサイト→[Download]のUsing jQuery with a CDNを探し、その中のコードの１行をheadタグの中に入れましょう。  
    &lt;script src="//code.jquery.com/jquery-◯.◯.◯.min.js"&gt;&lt;/script&gt;になります。
4. 更にCordovaプラグインでgeolocationプラグインを有効にしましょう。
    - [設定]→[Cordovaプラグインの管理]→[org.apache.codova.geolocation]を有効にしてください。
5. Google Maps機能の読み込みを行うために&lt;script&gt;タグで追加します。
    - &lt;script src="http://maps.googleapis.com/maps/api/js"&gt;&lt;/script&gt;
6. index.htmlの内容を書きましょう。
    -  &lt;ons-modal var="myModal"&gt;は、アプリ起動時に表示するモーダル画面(詳しくはWebで)として使用する。地図が表示されると同時に自動的に非表示となる。
    -  mapというidを持つ&lt;div&gt;タグを配置し、ここに地図が表示される。
7. mapにスタイルを定義して、画面全体に地図が描画されるように指定します。
    - style.cssに#mapのスタイルを書きましょう。
8. Javascriptは内容が多いため上から説明していければと思います。
    - app.jsの中身を書いていきましょう。
    - ons.bootstrap();を用いることで、onsenUIを読み込みます。もともとプロジェクトでonsenUIを使っていると、index.htmlのscriptタグで書いてあるかと思います。  
    もし、app.jsにも書いてあった場合には恐らくエラーを引き起こす要因になっているかもしれません。  
    onsenUIについては自分で調べてみてくださいね。
    - ons.ready()関数ではアプリを起動した際の処理を記述しています。  
    つまりはモーダル画面を表示してくださいという指示をしているということになります。  
    更にその後のコードでは現在地の取得を行い、得られた緯度、経度を中心として地図を描画するという内容を書いています。
    - その後３つの関数が書かれているかと思います。
        1. createMap()：地図の描画の処理
        2. putMarker()：マーカーを描画するための処理
        3. onError()：エラーの際の処理  
    ons.ready()関数の中で現在位置を取得出来るか出来ないかで呼び出す関数が違う事は分かるでしょうか?  
    取得ができればcreateMap()を呼び出し、失敗すれば文字通りonError()を呼び出すのです。  
    - エラー処理を見ておきます。
        1. コードの中にpositionError.codeという一文があります。これによって取得が出来なかった原因を判定出来ます。
            1. 位置情報の取得が許可されていない(ユーザーが位置情報のりようを許可しなかった場合)
            2. 位置情報の取得が行えない(ネットワークに接続していないなど)
            3. オプションのtimeoutプロパティで指定した時間内に位置情報が得られなかった。　　
        上記をもとにダイアログを用いて警告を表示しているということになります。